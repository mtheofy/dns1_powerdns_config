recursor:
  rpzs:
    # Local policy zones
    - name: "/opt/powerdns/rpzlists/whitelist.rpz"
      includeSOA: true
      ignoreDuplicates: true
      defpol: NoAction

    - name: "/opt/powerdns/rpzlists/ntpredirect.rpz"
      includeSOA: false
      ignoreDuplicates: true
      defpol: Custom
      defcontent: "ntp-fixed.home.arpa"

    - name: "/opt/powerdns/rpzlists/rewrite.rpz"
      includeSOA: true
      ignoreDuplicates: true

    - name: "/opt/powerdns/rpzlists/nxzones.rpz"
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "nxzones-list"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN

    # abuse.ch lists
    - name: 'rpz.urlhaus.abuse.ch'
      addresses: ['54.36.110.62']
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "urlhaus.rpz"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN
      dumpFile: '/opt/powerdns/rpzlists/urlhaus.rpz'
      seedFile: '/opt/powerdns/rpzlists/urlhaus.rpz'

    - name: '/opt/powerdns/rpzlists/threatfox.rpz'
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "threatfox.rpz"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN

    # hagezi lists
    - name: "/opt/powerdns/rpzlists/hagezy-multi-normal.rpz"
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "hagezy-multipro"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN

    - name: '/opt/powerdns/rpzlists/tif.rpz'
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "hagezy-tif"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN

    - name: '/opt/powerdns/rpzlists/fake.rpz'
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "hagezy-fake"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN

    - name: '/opt/powerdns/rpzlists/doh-vpn-proxy-bypass.rpz'
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "doh-vpn-proxy-bypass"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN

    # ioc2rpz lists
    - name: 'blox-malicious.ioc2rpz'
      addresses: ['94.130.30.123', '2a01:4f8:121:43ea::100:53']
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "blox-malicious.ioc2rpz"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN
      dumpFile: '/opt/powerdns/rpzlists/blox-malicious.ioc2rpz.rpz'
      seedFile: '/opt/powerdns/rpzlists/blox-malicious.ioc2rpz.rpz'
      tsig:
        name: 'ioc2rpz-net-509bfebb605d4f5db983'
        algo: 'hmac-sha256'
        secret: '+FV1Xh6L8WDeSqBz3wF25Q=='

    - name: 'phishtank.ioc2rpz'
      addresses: ['94.130.30.123', '2a01:4f8:121:43ea::100:53']
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "phishtank.ioc2rpz"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN
      dumpFile: '/opt/powerdns/rpzlists/phishtank.ioc2rpz.rpz'
      seedFile: '/opt/powerdns/rpzlists/phishtank.ioc2rpz.rpz'
      tsig:
        name: 'ioc2rpz-net-509bfebb605d4f5db983'
        algo: 'hmac-sha256'
        secret: '+FV1Xh6L8WDeSqBz3wF25Q=='

    - name: 'shreshta-nrd-1w.ioc2rpz'
      addresses: ['94.130.30.123', '2a01:4f8:121:43ea::100:53']
      axfrTimeout: 60
      includeSOA: true
      extendedErrorCode: 17
      extendedErrorExtra: "shreshta-nrd-1w.ioc2rpz"
      ignoreDuplicates: true
      defttl: 3600
      defpol: NXDOMAIN
      dumpFile: '/opt/powerdns/rpzlists/shreshta-nrd-1w.ioc2rpz.rpz'
      seedFile: '/opt/powerdns/rpzlists/shreshta-nrd-1w.ioc2rpz.rpz'
      tsig:
        name: 'ioc2rpz-net-509bfebb605d4f5db983'
        algo: 'hmac-sha256'
        secret: '+FV1Xh6L8WDeSqBz3wF25Q=='
